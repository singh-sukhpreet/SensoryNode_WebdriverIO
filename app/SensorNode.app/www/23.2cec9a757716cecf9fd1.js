(window.webpackJsonp=window.webpackJsonp||[]).push([[23],{mcMp:function(n,e,t){"use strict";t.d(e,"a",function(){return a});var l=t("mrSG"),o=t("ccyI"),u=t("sE5F"),r=t("67Y/"),i=t("CcnG"),s="https://g9spnwib9k.execute-api.ap-southeast-2.amazonaws.com/v1/",a=function(){function n(n,e){this.http=n,this.authService=e}return n.prototype.removeIllegalChars=function(n){var e=JSON.stringify(n);return console.log("tempStr = "+e),e=e.replace(/[']/g,""),JSON.parse(e)},n.prototype.putReport=function(n,e,t,l){var o=this;return new Promise(function(i,a){o.authService.getAuthenticatedUser().getSession(function(c,b){if(c)return console.log("Error refreshing user session in get Put Report method.",c),a(c);o.http.put(s+"report/?fromTime="+e+"&toTime="+t+"&proxyEmail="+l,n,{headers:new u.d({Authorization:b.getIdToken().getJwtToken()})}).pipe(Object(r.a)(function(n){return n.json()})).subscribe(function(n){return console.log("data : ",n),i(n)},function(n){return console.log("Error in subscribe block. ",n),a(n)})})})},n.prototype.putReportAnalytics=function(n,e,t,l,o,i){var a=this;return new Promise(function(c,b){a.authService.getAuthenticatedUser().getSession(function(d,g){if(d)return console.log("Error refreshing user session in get Put Report method.",d),b(d);a.http.put(s+"report-analytics/?fromTime="+e+"&toTime="+t+"&proxyEmail="+l+"&rmdFile="+o+"&reportParams="+i,n,{headers:new u.d({Authorization:g.getIdToken().getJwtToken()})}).pipe(Object(r.a)(function(n){return n.json()})).subscribe(function(n){return console.log("data : ",n),c(n)},function(n){return console.log("Error in subscribe block. ",n),b(n)})})})},n.prototype.getDeviceData=function(n,e,t){var l=this;return console.log("Let's grab some data for device : "+n),new Promise(function(o,i){l.authService.getAuthenticatedUser().getSession(function(a,c){if(a)return console.log("Error refreshing user session in get Data method.",a),i(a);l.http.get(s+"data/"+n+"?fromTime="+e+"&toTime="+t,{headers:new u.d({Authorization:c.getIdToken().getJwtToken()})}).pipe(Object(r.a)(function(n){return n.json()})).subscribe(function(e){try{if("all"===n){var t=e.body.filter(function(n){return"C"===n.id.charAt(0)||"W"===n.id.charAt(0)||"S"===n.id.charAt(0)||"F"===n.id.charAt(0)||"P"===n.id.charAt(0)||n.id.charAt(0)<="9"});e.body=t}}catch(a){console.log("GetDeviceError = ",a)}return o(e)},function(n){return console.log("Error in subscribe block. ",n),i(n)})})})},n.prototype.deleteData=function(n){console.log("deleting Device Data : ",n);var e=this;return new Promise(function(t,l){e.authService.getAuthenticatedUser().getSession(function(o,i){if(o)return console.log("Error refreshing user session in delete Data method.",o),l(o);e.http.delete(s+"data/"+n,{headers:new u.d({Authorization:i.getIdToken().getJwtToken()})}).pipe(Object(r.a)(function(n){return n.json()})).subscribe(function(n){return console.log("data : ",n),t(n)},function(n){return console.log("Error in subscribe block. ",n),l(n)})})})},n.prototype.getDeviceList=function(n){var e=this;return new Promise(function(t,l){e.authService.getAuthenticatedUser().getSession(function(o,i){if(o)return console.log("Error refreshing user session",o),l(o);console.log("inside authservice get session."),e.http.get(s+"devices/"+n,{headers:new u.d({Authorization:i.getIdToken().getJwtToken()})}).pipe(Object(r.a)(function(n){return n.json()})).subscribe(function(n){var e=n.body.filter(function(n){return"C"===n.deviceId.charAt(0)||"W"===n.deviceId.charAt(0)||"S"===n.deviceId.charAt(0)||"F"===n.deviceId.charAt(0)||"P"===n.deviceId.charAt(0)||n.deviceId.charAt(0)<="9"});return t(e)},function(n){return console.log("Error in subscribe block. ",n),l(n)})})})},n.prototype.putDevice=function(n){var e=this;return console.log("putting device: ",n),n=this.removeIllegalChars(n),console.log("clean device: ",n),new Promise(function(t,l){e.authService.getAuthenticatedUser().getSession(function(o,i){if(o)return console.log("Error refreshing user session",o),l(o);console.log("inside authservice get session."),e.http.put(s+"devices/"+n.deviceId,n,{headers:new u.d({Authorization:i.getIdToken().getJwtToken()})}).pipe(Object(r.a)(function(n){return n.json()})).subscribe(function(n){return console.log("data : ",n),t(n)},function(n){return console.log("Error in subscribe block. ",n),l(n)})})})},n.prototype.putIntervention=function(n,e){var t=this;console.log("putting intervention: ",e),e=this.removeIllegalChars(e);for(var l=0,o=Object.keys(e);l<o.length;l++){var i=o[l];""===e[i]&&(e[i]=" ");try{if(Array.isArray(e[i]))for(var a=0;a<e[i].length;a++)""===e[i][a]&&e[i].splice(a,1)}catch(c){console.log("Error removing empty array object: ",i,e[i],c)}}return console.log("after replacing empty strings: ",e),new Promise(function(l,o){t.authService.getAuthenticatedUser().getSession(function(i,a){if(i)return console.log("Error refreshing user session",i),o(i);console.log("inside authservice get session."),t.http.put(s+"intervention/"+n,e,{headers:new u.d({Authorization:a.getIdToken().getJwtToken()})}).pipe(Object(r.a)(function(n){return n.json()})).subscribe(function(n){return console.log("data : ",n),l(n)},function(n){return console.log("Error in subscribe block. ",n),o(n)})})})},n.prototype.deleteIntervention=function(n,e){console.log("deleting Intervention from - ",n);var t=this;return new Promise(function(l,o){t.authService.getAuthenticatedUser().getSession(function(i,a){if(i)return console.log("Error refreshing user session in delete intervention method.",i),o(i);t.http.delete(s+"intervention/"+n+"?ts="+e.ts,{headers:new u.d({Authorization:a.getIdToken().getJwtToken()})}).pipe(Object(r.a)(function(n){return n.json()})).subscribe(function(n){return console.log("data : ",n),l(n)},function(n){return console.log("Error in subscribe block. ",n),o(n)})})})},n.prototype.getInterventions=function(n){var e=this;return new Promise(function(t,l){e.authService.getAuthenticatedUser().getSession(function(o,i){if(o)return console.log("Error refreshing user session",o),l(o);console.log("inside authservice get session."),e.http.get(s+"intervention/"+n,{headers:new u.d({Authorization:i.getIdToken().getJwtToken()})}).pipe(Object(r.a)(function(n){return n.json()})).subscribe(function(n){return console.log("data in api service : ",n),t(n)},function(n){return console.log("Error in subscribe block. ",n),l(n)})})})},n.prototype.putUserSupport=function(n){return l.a(this,void 0,void 0,function(){var e=this;return l.c(this,function(t){switch(t.label){case 0:return[4,this.authService.getAttribute("preferred_username")];case 1:return t.sent(),[2,new Promise(function(t,l){e.authService.getAuthenticatedUser().getSession(function(o,i){if(o)return console.log("Error refreshing user session",o),l(o);var a="?searchVal="+n;console.log("inside authservice get session."),e.http.put(s+"user-support/"+a,{supportDescription:n},{headers:new u.d({Authorization:i.getIdToken().getJwtToken()})}).pipe(Object(r.a)(function(n){return n.json()})).subscribe(function(n){return console.log("data : ",n),t(n)},function(n){return console.log("Error in subscribe block. ",n),l(n)})})})]}})})},n.ngInjectableDef=i.S({factory:function(){return new n(i.W(u.e),i.W(o.a))},token:n,providedIn:"root"}),n}()},t0rX:function(n,e,t){"use strict";t.r(e);var l=t("CcnG"),o=t("mrSG"),u=t("ZZ/e"),r=t("mcMp"),i=t("Gs5E"),s=t("mMyO"),a=function(){function n(n,e,t,l,o,u,r){this.storage=n,this.sensorNodeApiProvider=e,this.loadingCtrl=t,this.router=l,this.route=o,this.ga=u,this.redirectService=r,this.message="",this.startDate=(new Date).toISOString(),this.endDate=(new Date).toISOString();var i=new Date;i.setDate(i.getDate()-1),this.startDate=i.toISOString()}return n.prototype.ngOnInit=function(){this.ga.sendPageView("device-customise","device-customise"),this.deviceId=this.route.snapshot.paramMap.get("deviceId")},n.prototype.onGetCustomData=function(){return o.a(this,void 0,void 0,function(){var n,e,t,l,u,r,i,s,a,c,b;return o.c(this,function(o){switch(o.label){case 0:return[4,this.loadingCtrl.create({message:"Updating Custom Data Range"})];case 1:return[4,(n=o.sent()).present()];case 2:o.sent(),e=Date.parse(this.startDate),t=new Date(e).getHours(),l=new Date(e).getMinutes(),r=86400-(u=3600*t+60*l)-60,i=Math.floor((new Date).getTime()/1e3),s=Math.floor(Date.parse(this.startDate)/1e3-u),a=Math.floor(Date.parse(this.endDate)/1e3+r),i<a&&(a=i),s>a&&(s=a-86400),console.log("start date : ",s),console.log("end date   : ",a),s<a-2592e3&&(s=a-2592e3,this.message="Maximum Query Length 30 days."),o.label=3;case 3:return o.trys.push([3,6,,7]),[4,this.sensorNodeApiProvider.getDeviceData(this.deviceId,s.toString(),a.toString())];case 4:return c=o.sent(),this.dataArray=c.body.data,[4,this.storage.set(this.deviceId+"_custom",{id:this.deviceId,data:this.dataArray})];case 5:return o.sent(),n.dismiss(),this.returnCustomData(),[3,7];case 6:return b=o.sent(),console.log(b),n.dismiss(),[3,7];case 7:return[2]}})})},n.prototype.returnCustomData=function(){this.redirectService.redirect("/device/data/",this.deviceId,"?customRange=true")},n.prototype.cancel=function(){this.redirectService.redirect("/device/data/",this.deviceId,"?customRange=false")},n}(),c=function(){return function(){}}(),b=t("pMnS"),d=t("oBZk"),g=t("gIcY"),h=t("iw74"),p=t("ZYCi"),f=l.nb({encapsulation:0,styles:[[""]],data:{}});function v(n){return l.Ib(0,[(n()(),l.pb(0,0,null,null,11,"ion-header",[],null,null,null,d.ib,d.r)),l.ob(1,49152,null,0,u.C,[l.h,l.k],null,null),(n()(),l.pb(2,0,null,0,9,"ion-toolbar",[],null,null,null,d.Gb,d.P)),l.ob(3,49152,null,0,u.Cb,[l.h,l.k],null,null),(n()(),l.pb(4,0,null,0,4,"ion-buttons",[["slot","start"]],null,null,null,d.V,d.e)),l.ob(5,49152,null,0,u.m,[l.h,l.k],null,null),(n()(),l.pb(6,0,null,0,2,"ion-back-button",[],null,[[null,"click"]],function(n,e,t){var o=!0;return"click"===e&&(o=!1!==l.zb(n,8).onClick(t)&&o),o},d.S,d.b)),l.ob(7,49152,null,0,u.h,[l.h,l.k],null,null),l.ob(8,16384,null,0,u.i,[[2,u.ib],u.Jb],null,null),(n()(),l.pb(9,0,null,0,2,"ion-title",[],null,null,null,d.Eb,d.N)),l.ob(10,49152,null,0,u.Ab,[l.h,l.k],null,null),(n()(),l.Gb(-1,0,["Custom Data Range"])),(n()(),l.pb(12,0,null,null,58,"ion-content",[],null,null,null,d.eb,d.n)),l.ob(13,49152,null,0,u.v,[l.h,l.k],null,null),(n()(),l.pb(14,0,null,0,56,"ion-list",[["text-wrap",""]],null,null,null,d.nb,d.w)),l.ob(15,49152,null,0,u.P,[l.h,l.k],null,null),(n()(),l.pb(16,0,null,0,0,"p",[["style","padding-top: 20px;"]],null,null,null,null,null)),(n()(),l.pb(17,0,null,0,8,"ion-row",[],null,null,null,d.sb,d.B)),l.ob(18,49152,null,0,u.jb,[l.h,l.k],null,null),(n()(),l.pb(19,0,null,0,1,"ion-col",[],null,null,null,d.db,d.m)),l.ob(20,49152,null,0,u.u,[l.h,l.k],null,null),(n()(),l.pb(21,0,null,0,2,"ion-col",[["size","4"],["size-lg","2"],["size-md","3"],["size-xl","2"]],null,null,null,d.db,d.m)),l.ob(22,49152,null,0,u.u,[l.h,l.k],{size:[0,"size"]},null),(n()(),l.pb(23,0,null,0,0,"img",[["alt","dataRange"],["src","assets/images/customRange.svg"],["style","width: 100%;"]],null,null,null,null,null)),(n()(),l.pb(24,0,null,0,1,"ion-col",[],null,null,null,d.db,d.m)),l.ob(25,49152,null,0,u.u,[l.h,l.k],null,null),(n()(),l.pb(26,0,null,0,0,"p",[["style","padding-top: 20px;"]],null,null,null,null,null)),(n()(),l.pb(27,0,null,0,43,"ion-row",[["justify-content-center",""]],null,null,null,d.sb,d.B)),l.ob(28,49152,null,0,u.jb,[l.h,l.k],null,null),(n()(),l.pb(29,0,null,0,41,"ion-col",[["size","12"],["size-md","6"],["size-xl","4"]],null,null,null,d.db,d.m)),l.ob(30,49152,null,0,u.u,[l.h,l.k],{size:[0,"size"]},null),(n()(),l.pb(31,0,null,0,7,"ion-item",[["lines","none"]],null,null,null,d.lb,d.u)),l.ob(32,49152,null,0,u.I,[l.h,l.k],{lines:[0,"lines"]},null),(n()(),l.pb(33,0,null,0,5,"ion-label",[],null,null,null,d.mb,d.v)),l.ob(34,49152,null,0,u.O,[l.h,l.k],null,null),(n()(),l.pb(35,0,null,0,3,"ion-text",[],null,null,null,d.Cb,d.L)),l.ob(36,49152,null,0,u.xb,[l.h,l.k],null,null),(n()(),l.pb(37,0,null,0,1,"h5",[["style","font-size: 1.2rem;"],["text-center",""]],null,null,null,null,null)),(n()(),l.Gb(-1,null,[" Choose Custom Range (30 days Max) "])),(n()(),l.pb(39,0,null,0,11,"ion-item",[],null,null,null,d.lb,d.u)),l.ob(40,49152,null,0,u.I,[l.h,l.k],null,null),(n()(),l.pb(41,0,null,0,2,"ion-label",[],null,null,null,d.mb,d.v)),l.ob(42,49152,null,0,u.O,[l.h,l.k],null,null),(n()(),l.Gb(-1,0,["Show Data From : "])),(n()(),l.pb(44,0,null,0,6,"ion-datetime",[["display-format","MMM DD, YYYY"],["min","2018"],["picker-format","MMM DD YYYY"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"],[null,"ionBlur"],[null,"ionChange"]],function(n,e,t){var o=!0,u=n.component;return"ionBlur"===e&&(o=!1!==l.zb(n,45)._handleBlurEvent()&&o),"ionChange"===e&&(o=!1!==l.zb(n,45)._handleChangeEvent(t.target.value)&&o),"ngModelChange"===e&&(o=!1!==(u.startDate=t)&&o),o},d.fb,d.o)),l.ob(45,16384,null,0,u.Ob,[l.k],null,null),l.Db(1024,null,g.f,function(n){return[n]},[u.Ob]),l.ob(47,671744,null,0,g.k,[[8,null],[8,null],[8,null],[6,g.f]],{model:[0,"model"]},{update:"ngModelChange"}),l.Db(2048,null,g.g,null,[g.k]),l.ob(49,16384,null,0,g.h,[[4,g.g]],null,null),l.ob(50,49152,null,0,u.w,[l.h,l.k],{min:[0,"min"]},null),(n()(),l.pb(51,0,null,0,11,"ion-item",[],null,null,null,d.lb,d.u)),l.ob(52,49152,null,0,u.I,[l.h,l.k],null,null),(n()(),l.pb(53,0,null,0,2,"ion-label",[],null,null,null,d.mb,d.v)),l.ob(54,49152,null,0,u.O,[l.h,l.k],null,null),(n()(),l.Gb(-1,0,["Until : "])),(n()(),l.pb(56,0,null,0,6,"ion-datetime",[["display-format","MMM DD, YYYY"],["min","2018"],["picker-format","MMM DD YYYY"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"],[null,"ionBlur"],[null,"ionChange"]],function(n,e,t){var o=!0,u=n.component;return"ionBlur"===e&&(o=!1!==l.zb(n,57)._handleBlurEvent()&&o),"ionChange"===e&&(o=!1!==l.zb(n,57)._handleChangeEvent(t.target.value)&&o),"ngModelChange"===e&&(o=!1!==(u.endDate=t)&&o),o},d.fb,d.o)),l.ob(57,16384,null,0,u.Ob,[l.k],null,null),l.Db(1024,null,g.f,function(n){return[n]},[u.Ob]),l.ob(59,671744,null,0,g.k,[[8,null],[8,null],[8,null],[6,g.f]],{model:[0,"model"]},{update:"ngModelChange"}),l.Db(2048,null,g.g,null,[g.k]),l.ob(61,16384,null,0,g.h,[[4,g.g]],null,null),l.ob(62,49152,null,0,u.w,[l.h,l.k],{min:[0,"min"]},null),(n()(),l.pb(63,0,null,0,4,"ion-button",[["expand","block"],["margin-top","50px"]],null,[[null,"click"]],function(n,e,t){var l=!0;return"click"===e&&(l=!1!==n.component.onGetCustomData()&&l),l},d.U,d.d)),l.ob(64,49152,null,0,u.l,[l.h,l.k],{expand:[0,"expand"]},null),(n()(),l.pb(65,0,null,0,1,"ion-icon",[["name","stats"],["slot","end"]],null,null,null,d.jb,d.s)),l.ob(66,49152,null,0,u.D,[l.h,l.k],{name:[0,"name"]},null),(n()(),l.Gb(-1,0,[" Show "])),(n()(),l.pb(68,0,null,0,2,"ion-button",[["expand","block"],["fill","outline"],["margin-top","50px"]],null,[[null,"click"]],function(n,e,t){var l=!0;return"click"===e&&(l=!1!==n.component.cancel()&&l),l},d.U,d.d)),l.ob(69,49152,null,0,u.l,[l.h,l.k],{expand:[0,"expand"],fill:[1,"fill"]},null),(n()(),l.Gb(-1,0,["Cancel"]))],function(n,e){var t=e.component;n(e,22,0,"4"),n(e,30,0,"12"),n(e,32,0,"none"),n(e,47,0,t.startDate),n(e,50,0,"2018"),n(e,59,0,t.endDate),n(e,62,0,"2018"),n(e,64,0,"block"),n(e,66,0,"stats"),n(e,69,0,"block","outline")},function(n,e){n(e,44,0,l.zb(e,49).ngClassUntouched,l.zb(e,49).ngClassTouched,l.zb(e,49).ngClassPristine,l.zb(e,49).ngClassDirty,l.zb(e,49).ngClassValid,l.zb(e,49).ngClassInvalid,l.zb(e,49).ngClassPending),n(e,56,0,l.zb(e,61).ngClassUntouched,l.zb(e,61).ngClassTouched,l.zb(e,61).ngClassPristine,l.zb(e,61).ngClassDirty,l.zb(e,61).ngClassValid,l.zb(e,61).ngClassInvalid,l.zb(e,61).ngClassPending)})}function m(n){return l.Ib(0,[(n()(),l.pb(0,0,null,null,1,"app-report",[],null,null,null,v,f)),l.ob(1,114688,null,0,a,[h.b,r.a,u.Gb,p.m,p.a,s.a,i.a],null,null)],function(n,e){n(e,1,0)},null)}var k=l.lb("app-report",a,m,{},{},[]),w=t("Ip0R");t.d(e,"ReportPageModuleNgFactory",function(){return D});var D=l.mb(c,[],function(n){return l.wb([l.xb(512,l.j,l.bb,[[8,[b.a,k]],[3,l.j],l.x]),l.xb(4608,w.n,w.m,[l.u,[2,w.x]]),l.xb(4608,g.o,g.o,[]),l.xb(4608,u.c,u.c,[l.z,l.g]),l.xb(4608,u.Ib,u.Ib,[u.c,l.j,l.q,w.d]),l.xb(4608,u.Mb,u.Mb,[u.c,l.j,l.q,w.d]),l.xb(1073742336,w.c,w.c,[]),l.xb(1073742336,g.m,g.m,[]),l.xb(1073742336,g.b,g.b,[]),l.xb(1073742336,u.Eb,u.Eb,[]),l.xb(1073742336,p.o,p.o,[[2,p.v],[2,p.m]]),l.xb(1073742336,c,c,[]),l.xb(1024,p.k,function(){return[[{path:"",component:a}]]},[])])})}}]);